# [2. 词法分析](https://docs.python.org/3/reference/lexical_analysis.html)

Python程序由*解析器*读取。输入到解析器中的是由*词法分析器*生成的标记流。本章描述词法分析器如何把一个文件拆分成标记。

Python将程序文本作为Unicode码点读取；源文件的编码由编码声明给出，默认值为UTF-8，详细信息参考[**PEP 3120**](https://www.python.org/dev/peps/pep-3120/)。如果源文件不能被解码，将引发[SyntaxError](https://docs.python.org/3/library/exceptions.html#SyntaxError)异常。

## [2.1. 行结构](https://docs.python.org/3/reference/lexical_analysis.html#line-structure)

Python程序被拆分为多个*逻辑行*。

### [2.1.1. 逻辑行](https://docs.python.org/3/reference/lexical_analysis.html#logical-lines)

逻辑行的结束由 NEWLINE 标记表示。除非语法允许 NEWLINE（e.g. 复合语句的语句之间），否则语句不能跨越逻辑行的边界。逻辑行由一个或多个*物理行*构建，并遵循显式或隐式*行连接*规则。

### [2.1.2. 物理行](https://docs.python.org/3/reference/lexical_analysis.html#physical-lines)

物理行是一个 end-of-line 序列终止的字符序列。在源文件中，可以使用任何标准平台的行终止序列——Unix形式使用 ASCII 的 LF（换行），windows形式使用 ASCII 序列 CR LF（回车，换行），或者Macintosh过去使用的 ACSII 的 CR（回车）字符。

在嵌入Python时，对于换行符源代码字符串，应该使用标准C的习惯传递给 Python API（`\n`字符，相当于 ASCII LF，作为行终止符）。

### [2.1.3. 注释](https://docs.python.org/3/reference/lexical_analysis.html#comments)

注释以井号`#`开头，以该物理行结束处中止。（注释字符串并不包含`#`)。注释表示逻辑行的结尾，除非调用隐式行连接。语法忽略注释；注释不是标记。

### [2.1.4. 编码声明](https://docs.python.org/3/reference/lexical_analysis.html#encoding-declarations)


如果Python脚本的第一行或第二行注释匹配正则表达式`coding[=:]\s*([-\w.]+)`，该注释将作为编码声明处理；该表达式的第一个分组给出了该源文件的编码。编码声明必须出现在自己的一行上。如果它处于第二行，第一行也必须为纯注释行。编码声明的推荐格式为

```python
# -*- coding: <encoding-name> -*-
```

这是被GNU Emacs认可的，以及

```python
# vim:fileencoding=<encoding-name>
```

这是被Bram Moolenaar 的 VIM认可的。

如果没有找到编码声明，将被默认声明为 UTF-8。此外，如果该文件开始的几个字节是UTF-8的字节顺序标记（`b'\xef\xbb\xbf'`）。该编码声明为 UTF-8。（这个特性也被微软的**notepad**和其它编辑器支持。）


如果编码被声明，该编码必须能被Python识别。该编码被用于所有的词法分析，包括字符串字面值，注释和标识符。



### [2.1.5. 显式行连接](https://docs.python.org/3/reference/lexical_analysis.html#explicit-line-joining)

### [2.1.6. 隐式行连接](https://docs.python.org/3/reference/lexical_analysis.html#implicit-line-joining)

### [2.1.7. 空白行](https://docs.python.org/3/reference/lexical_analysis.html#blank-lines)

### [2.1.8. 缩进](https://docs.python.org/3/reference/lexical_analysis.html#indentation)
